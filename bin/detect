#!/usr/bin/env bash

BUILD_DIR=$1

if [ ! -f "$BUILD_DIR/poetry.lock" ]; then
  exit 1
fi

echo "Let's install poetry. Yes, one more time"
curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py \
  | sed -e 's/allowed_executables = \["python", "python3"\]/allowed_executables = ["python3"]/' \
  | python3 \
  | indent


source $HOME/.poetry/env

cd "$BUILD_DIR"

poetry install
