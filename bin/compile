#!/usr/bin/env bash

BUILD_DIR="$1"

function log() {
        echo "-----> $*"
}

function indent() {
        c='s/^/       /'
        case $(uname) in
                Darwin) sed -l "$c";;
                *)      sed -u "$c";;
        esac
}

echo "Let's install poetry. Yes, one more time"
curl -sSL https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py \
  | sed -e 's/allowed_executables = \["python", "python3"\]/allowed_executables = ["python3"]/' \
  | python3 \
  | indent

cd "$BUILD_DIR"
source $HOME/.poetry/env


poetry install


